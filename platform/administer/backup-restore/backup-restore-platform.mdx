---
title: Backup & Restore vCluster Platform
sidebar_label: Backup & Restore
sidebar_position: 1
---

This guide describes how to backup and restore the vCluster Platform management plane. For backing up the connected clusters, reuse a regular Kubernetes backup solution such as [Velero](https://velero.io/).

vCluster Platform saves its state as Kubernetes CRD objects.  These can be either backed up via [Velero](https://velero.io) or through a special vCluster CLI command that we have created for convenience that saves all relevant Kubernetes resources to a single file. vCluster CLI allows you to backup these components whenever required. The backup includes these resources:
- ClusterRoleTemplates
- ClusterAccesses
- SpaceConstraints
- Users
- Teams
- SharedSecrets
- AccessKeys
- Apps
- SpaceTemplates
- VirtualClusterTemplates
- Clusters & Cluster Secrets
- Projects
- VirtualClusterInstances
- SpaceInstances
- ProjectSecrets

The platform backup includes only CRDs and does not cover other resources used by the platform deployment or connected clusters, such as persistent volumes storing cost data. Use a Kubernetes backup solution like [Velero](https://velero.io) to back up these resources separately.

To take a backup using the defaults, you can run the following command. This dumps the manifests of all the above listed components to a file in the current directory named 'backup.yaml'
```
vcluster platform backup management
```

Alternatively, you may specify the name for the backup file by running the command as:
```
vcluster platform backup management --filename vcluster-platform-backup.yaml
```

In some scenarios, vCluster Platform may have been installed in a different namespace instead of the default `vcluster-platform` namespace. You can provide this to the command as below:
```
vcluster platform backup management --namespace my-namespace
```

You can also choose to exclude certain components from the backup by supplying the names as a comma-separated string like below. This excludes users and teams from the backup.
```
vcluster platform backup management --skip users,teams
```

### Restore vCluster Platform from backup

The backup yaml file contains the manifests for the resources of the vCluster Platform Management plane. Hence, it can be used as any other Kubernetes manifest file.
To restore, simply apply the backup to your cluster using the below command:


:::note
The backup contains vCluster Platform custom resource definitions (CRDs) that need to be installed in the cluster for the restore to succeed.
:::

```
kubectl apply -f <backup-filename>.yaml
```

Note that you might see lots of warning messages similar to the following:

```
Warning: resource apps/argocd is missing the kubectl.kubernetes.io/last-applied-configuration annotation which is required by kubectl apply. kubectl apply should only be used on resources created declaratively by either kubectl create --save-config or kubectl apply. The missing annotation is patched automatically.
```

These are just warnings and should not affect the restoration task.

:::warning Multiple Kubernetes Clusters with the same vCluster Platform Config
Make sure that you are not installing vCluster Platform (and vCluster Platform Agents) into clusters with vCluster Platform already
running. Multiple vCluster Platform instances running on the same clusters can lead to conflicts in
reconciliation and may cause unexpected problems.
:::

