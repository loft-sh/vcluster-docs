---
title: Ingress Classes
sidebar_label: ingressClasses
sidebar_position: 3
description: Configuration for Ingress Classes in vCluster
---

import EnableSwitch from '../../../../_partials/config/sync/fromHost/ingressClasses.mdx'

{/*
`ingressClasses.enabled`:
- covered by the generic section here: https://www.vcluster.com/docs/syncer/config#enable-or-disable-synced-resources
- original issue: https://github.com/loft-sh/vcluster/issues/663
*/}

By default, this is disabled.

Sync IngressClass resources from the host cluster to the virtual cluster.

### Enable syncing IngressClasses from the host to virtual cluster

```YAML
sync:
  fromHost:
    ingressClasses:
      enabled: true
```

### Example
The following configuration syncs all IngressClasses that match the specified labels and expressions from the host cluster to the virtual cluster.

```YAML
sync:
  toHost:
    ingresses:
      enabled: true
  fromHost:
    ingressClasses:
      enabled: true
      selector:
        matchLabels:
          # Match all IngressClasses with the label `environment` with value `development`
          environment: "development"
        matchExpressions:
          # Match IngressClasses with the label `kubernetes.io/ingress.class` that are either `nginx` or `traefik`
          - key: "kubernetes.io/ingress.class"
            operator: In
            values:
              - nginx
              - traefik
```

The selector section uses the same syntax as the Kubernetes label selector, allowing you to filter which IngressClasses should be synced from the host based on their labels.
Note that all the criteria must match for an IngressClass to be included in the sync.

### How selector works

`matchLabels` and `matchExpressions` are used to filter IngressClasses based on their labels.
- matchLabels: This section allows you to specify exact label matches. For example, if you want to sync only IngressClasses with the label `environment: development`, you would specify it here.
- matchExpressions: This section allows for more complex queries. For example, if you want to sync IngressClasses with the label `kubernetes.io/ingress.class` that are either `nginx` or `traefik`, you would specify it here using the `In` operator. Allowed operators include `In`, `NotIn`, `Exists`, and `DoesNotExist`.

Refer to the [Kubernetes documentation on label selectors](https://kubernetes.io/docs/concepts/overview/working-with-objects/labels/#resources-that-support-set-based-requirements) for more details on how to use label selectors effectively.

When you enable the syncing of IngressClasses from the host cluster, the vCluster syncer looks for IngressClasses that match the specified selector criteria.

The selector limits not only the IngressClasses that are synced from the host but also the sync of the Ingress resources created in the virtual cluster to the host.
This ensures that only the relevant classes are available for use. So when trying to create an Ingress resource in the virtual cluster, it only allows the IngressClasses that match the specified selector criteria.

The Ingress resource sync to host fails when using an IngressClass that does not match the selector. An event is recorded for the Ingress in the virtual cluster, indicating that the IngressClass is not available in the host.
This should look like this:

```shell
vcluster-virtual-cluster-1:~$ kubectl describe ingress my-ingress
Name:             my-ingress
Namespace:        default
Ingress Class:    nginx
Events:
  Type     Reason            Age   From                Message
  ----     ------            ----  ----                -------
  Warning  SyncWarning       10s   ingress-syncer      did not sync ingress "my-ingress" to host because it does not match the selector under 'sync.fromHost.ingressClasses.selector'
```

### Use cases
- **Development Environments**: Sync specific IngressClasses that are used in development environments.
- **Multi-Tenancy**: Allow different teams to use their own IngressClasses while still sharing the same host cluster resources.
- **Security**: Limit the IngressClasses available in the virtual cluster to only those that are necessary.

### Important notes
- The synced IngressClasses is synced to the virtual cluster, allowing you to create Ingress resources that reference them.
- As soon as the IngressClass changes in the host cluster (ex. through a patch or update), the selector is re-evaluated, and the IngressClass is updated in the virtual cluster or deleted if it doesn't match the selector criteria.
- A Warning is logged in the stdout of the vCluster syncer pod if an IngressClass cannot be synced due to the selector criteria not matching.
- The already synced Ingresses are not deleted if the IngressClass is removed or does not match the criteria in the host cluster, but they are not updated anymore. If you want to remove them, you need to delete them manually in the host cluster.

## Config reference

<EnableSwitch/>
