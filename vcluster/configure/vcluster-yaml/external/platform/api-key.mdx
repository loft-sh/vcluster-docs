---
title: apiKey
sidebar_label: apiKey
sidebar_position: 1
---

import ProAdmonition from '../../../../_partials/admonitions/pro-admonition.mdx'

import ApiKey from '@site/platform/api/_partials/resources/config/external/platform/apiKey.mdx'
import Flow, { Step } from '@site/src/components/Flow';
import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';


<ProAdmonition/>

<!--vale off-->

This provides a way to connect directly to the vCluster Platform.

## Connect virtual clusters to the vCluster Platform 

To connect a virtual cluster to the vCluster Platform, you can use an API keyâ€”referred to as an [access key](/platform/next/api/authentication) in the platform's UI. There are two authentication methods:

- **Shared access key** (Recommended): Create a single Kubernetes Secret containing the access key, and reference it in multiple virtual clusters, even if they are deployed in different namespaces. This approach simplifies management, reduces overhead, and eases credential rotation, making it suitable for most users and production environments.

- **Individual access keys**: Create separate Kubernetes Secrets, each with a unique access key, for every virtual cluster. This method provides granular access control and allows revocation of access to individual clusters. This is beneficial in environments with strict security requirements where isolation is critical.

For most scenarios, using a shared access key is the preferred approach due to its simplicity and ease of maintenance.


<Tabs>
  <TabItem value="shared" label="Shared Access Key" default>
    <Flow>
      <Step title="Create the Secret">
        
        Create the `vcluster-platform-api-key` secret in the namespace the virtual cluster uses:
        
        ```bash
        kubectl create secret generic vcluster-platform-api-key \
          --from-literal=apiKey=<YOUR_API_KEY> \
          -n <SECRET_NAMESPACE>
        ```
       - Replace `<YOUR_API_KEY>` with your actual platform API key.
       - Replace `<SECRET_NAMESPACE>` with the namespace where you want to store the Secret.
      </Step>
      
      <Step title="Reference the Secret in vcluster.yaml">
        
        In your `vcluster.yaml` file, reference the Secret by namespace and enable RBAC creation:
        
        ```yaml title="API key configuration"
        external:
          platform:
            apiKey:
              secretName: vcluster-platform-api-key
              namespace: <SECRET_NAMESPACE>
              createRBAC: true
        ```
        - `secretName`: Specifies the name of the Secret containing the API key.
        - `namespace`: Specifies the namespace where the Secret is located. If different from the virtual cluster's namespace, ensure that the virtual cluster has access to this namespace.
        - `createRBAC`: When set to `true`, vCluster automatically creates the necessary `Role` and `RoleBinding` resources to allow access to the Secret.
      </Step>
    </Flow>
  </TabItem>
  
  <TabItem value="individual" label="Individual user access">
    <Step title="Configure vcluster.yaml">
      
      Set up your `vcluster.yaml` to use individual user authentication:
      
      ```yaml title="User-based authentication"
      external:
        platform:
          userBased: true
      ```
      
      With this configuration:
      - Each user must generate their own access key in the platform UI.
      - Users provide their personal access key when connecting to the virtual cluster.
      - No shared secret must be created or maintained.
    </Step>
  </TabItem>
</Tabs>

## Example

```
external:
  platform:
    apiKey:
      secretName: # Defaults to vcluster-platform-api-key if undefined
      namespace: # Namespace to search for the secret. If undefined, it searches the namespace that the vCluster is deployed in. If different than the namespace of the vCluster deployment, then vCluster needs access to that namespace.
      createRBAC: # Default enabled to create the necessary RBAC roles and role bindings in order to find the secret

```

## Config reference

<ApiKey />
