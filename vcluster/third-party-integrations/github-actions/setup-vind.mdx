---
title: CI testing with setup-vind
sidebar_label: CI Testing (setup-vind)
sidebar_position: 3
description: Use the setup-vind GitHub Action to provision Kubernetes clusters via vCluster's Docker driver for CI/CD testing.
---

The [`setup-vind`](https://github.com/loft-sh/setup-vind) GitHub Action provisions Kubernetes clusters via [vCluster's Docker driver (vind)](../../configure/vcluster-yaml/experimental/docker.mdx) for CI/CD testing. It is a drop-in replacement for `setup-kind` that removes the need for `kind load docker-image` because Docker images are available natively.

The action handles the full lifecycle automatically:

- **Main step**: installs the vCluster CLI, sets the Docker driver, creates the cluster, and waits for nodes to become ready.
- **Post step**: exports container logs as a GitHub artifact and deletes the cluster.

## Basic usage

```yaml
# .github/workflows/e2e.yaml
name: E2E Tests
on:
  pull_request:
    branches: [main]
jobs:
  e2e:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: loft-sh/setup-vind@v1
      - run: kubectl get nodes
      - run: make e2e
```

After the `setup-vind` step completes, `kubectl` is configured and the cluster is ready. The action waits up to 5 minutes for nodes to register before proceeding.

## Inputs

| Input | Default | Description |
|-------|---------|-------------|
| `version` | `latest` | vCluster CLI version to install |
| `name` | `vind` | Cluster name |
| `config` | | Path to `vcluster.yaml` values file (repo-relative) |
| `kubernetes-version` | | Kubernetes version for the cluster |
| `skipClusterDeletion` | `false` | Skip cluster deletion in post step |
| `skipClusterLogsExport` | `false` | Skip log export in post step |

## Examples

### Specify a Kubernetes version

```yaml
- uses: loft-sh/setup-vind@v1
  with:
    kubernetes-version: "1.35.0"
```

### Use a config file

```yaml
- uses: loft-sh/setup-vind@v1
  with:
    config: hack/vcluster.yaml
```

### Multi-cluster setup

Create multiple clusters in the same job by giving each a unique name:

```yaml
- uses: loft-sh/setup-vind@v1
  with:
    name: platform
- uses: loft-sh/setup-vind@v1
  with:
    name: agent
```

## Migrate from setup-kind

| `setup-kind` | `setup-vind` | Notes |
|------------|------------|-------|
| `version: v0.30.0` | `version: v0.32.0` | vCluster CLI version, not KinD |
| `image: kindest/node:v1.35.0` | `kubernetes-version: "1.35.0"` | No node image needed |
| `config: kind.yaml` | `config: vcluster.yaml` | Different config format (vCluster values) |
| `kind load docker-image` | *(not needed)* | Docker images available natively via vind |

## Requirements and limitations

- **Linux only** - the action supports `linux/amd64` and `linux/arm64` runners.
- **Docker required** - the runner must have Docker installed (standard on `ubuntu-latest`).
- **Kernel modules** - the action pre-loads `br_netfilter`, `overlay`, and `bridge` modules automatically. No user action needed.
