---
title: Metrics server
sidebar_label: Metrics Server
sidebar_position: 3
sidebar_class_name: host-nodes
---

import MetricsServer from '@site/vcluster/_fragments/metrics-server.mdx'
import TenancySupport from '../_fragments/tenancy-support.mdx';

<TenancySupport hostNodes="true" />

### Installing metrics server (inside vCluster)

In case the above recommended method of getting metrics in vCluster using the metrics server proxy does not fulfill your requirements and you need a dedicated metrics server installation in the vCluster you can follow this section.
Make sure the vCluster has access to the host clusters nodes.

Install the [metrics server](https://github.com/kubernetes-sigs/metrics-server#installation) via the official method into the vCluster.

Wait until the metrics server has started. You should be now able to use `kubectl top pods` and `kubectl top nodes` within the vCluster:
```
kubectl top pods --all-namespaces
NAMESPACE     NAME                              CPU(cores)   MEMORY(bytes)
kube-system   coredns-854c77959c-q5878          3m           17Mi
kube-system   metrics-server-5fbdc54f8c-fgrqk   0m           6Mi
```

### How does it work?

By default, vCluster will create a service for each node that redirects incoming traffic from within the vCluster to the node kubelet to vCluster itself. This means that if workloads within the vCluster try to scrape node metrics the traffic reaches vCluster first. Vcluster will redirect the incoming request to the host cluster, rewrite the response (pod names, pod namespaces etc) and return it to the requester.


<MetricsServer />
