---
title: How are volume snapshots created?
sidebar_label: Volume snapshots creation
sidebar_position: 3
sidebar_class_name: host-nodes private-nodes
---

import Flow, { Step } from '@site/src/components/Flow';
import TenancySupport from '../_fragments/tenancy-support.mdx';

<TenancySupport hostNodes="true" privateNodes="true" />

When working with stateful applications, it is important to understand how is your data handled. This is particularly important when it comes to disaster recovery scenarios, where understanding how your data is backed up and restored can go a long way when it comes to protecting your data and properly reacting in case of an incident.

vCluster uses [Kubernetes Volume Snapshots](https://kubernetes.io/docs/concepts/storage/volume-snapshots/) feature to create snapshots of your Kubernetes volumes and to restore them when needed. This document describes how the snapshot and restore process is working.

## How are volume snapshots created?

This section start with describing who or what is responsible for which part of the volume snapshot creation process.

**Host cluster user**:
- Runs the vCluster CLI commands;
- Configures storage components in the host or in the virtual cluster, depending on the multi-tenancy model.

**vCluster CLI**:
- Creates snapshot requests in the host cluster.

**vCluster snapshot controller**:
- Processes and updates snapshot request that created in the host cluster;
- Creates dynamic VolumeSnapshots in the host or in the virtual cluster, depending on the multi-tenancy model.

**Kubernetes snapshot-controller**:
- Runs in the host or in the virtual cluster, depending on the multi-tenancy model;
- Processes and updates dynamic VolumeSnapshots;
- Creates VolumeSnapshotContent resources.

**External snapshotter CSI driver sidecar**:
- Runs as a sidecar container in the CSI driver pod in the host or in the virtual cluster, depending on the multi-tenancy model;
- Processes VolumeSnapshotContent resources;
- Talks to the CSI driver via RPCs (CreateSnapshot, DeleteSnapshot, and, optionally, the ListSnapshots).

**CSI Driver**:
- Runs in the host or in the virtual cluster, depending on the multi-tenancy model;
- Makes provider-specific API calls to create, delete, or list provider-specific disk snapshots.

### Create volume snapshots with shared host nodes

TBA details and sequence charts

### Create volume snapshots with private nodes

TBA details and sequence charts

## How are volumes restored from snapshots?

This section describes who or what is responsible for which part of the volume restore process.

TBA

### Restore volumes with shared host nodes

TBA details and sequence charts

### Restore volumes with private nodes

TBA details and sequence charts
