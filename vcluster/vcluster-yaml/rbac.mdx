---
title: RBAC
sidebar_label: rbac
sidebar_position: 7
description: Configuration for ...
---

import RBAC from '@site/vcluster/_partials/config/rbac.mdx'

Most rules required to operate your vCluster are automatically generated by [enabling resource syncing](../vcluster-yaml/sync/).

:::note
When enabled, the following config fields may adjust default rules:

- [controlPlane.advanced.virtualScheduler](../vcluster-yaml/control-plane/other/advanced/virtual-scheduler.mdx): adds required read permissions for the virtual scheduler
- [networking.replicateServices.fromHost](vcluster/vcluster-yaml/networking/replicate-services.mdx): adds required permissions to manage endpoints and services
- [observability.metrics.proxy.nodes](vcluster/vcluster-yaml/observability/metrics.mdx): adds required read permissions for node resources
- [plugins](../vcluster-yaml/plugins.mdx): adds `roles` and `clusterRoles` defined by each plugin
- [experimental.multiNamespaceMode](../vcluster-yaml/experimental/multi-namespace-mode.mdx): adds required permissions for vCluster to manage namespaces and service accounts
- [experimental.genericSync](../vcluster-yaml/experimental/generic-sync.mdx): adds `extraRules` defined by generic sync
:::

## Disable RBAC

In environments with strict controls where users cannot create service accounts, you may configure vCluster to use a managed service account. An administrator would be responsible for managing the Role, RoleBinding, ClusterRole, ClusterRoleBinding, and ServiceAccount resources. After you create these, update the `vcluster.yaml` to disable RBAC, and configure the control plane to use the managed ServiceAccount:

```yaml
controlPlane:
  advanced:
    serviceAccount:
      name: custom-vc-sa
rbac:
  role:
    enabled: false
  clusterRole:
    enabled: false
```

Alternatively, you may disable `ClusterRole` creation, as many users do not have the required permissions to create `ClusterRole` resources:

```yaml
rbac:
  clusterRole:
    enabled: false
```

## Extra Rules

Configure extra rules for when the automatically generated rules, [plugin](../vcluster-yaml/plugins.mdx) rules, and [genericSync](../vcluster-yaml/experimental/generic-sync.mdx) rules are insufficient. The usage of `extraRules` should be rare, but this example shows its usage.

```yaml
rbac:
  role:
    enabled: true
    extraRules:
      - apiGroups: [""]
        resources: ["pods/status", "pods/ephemeralcontainers"]
        verbs: ["patch", "update"]
```

## Overwrite Rules

For better control use `overwriteRules` to ignore the automatically created rules. You are responsible for enumerating rules required for vCluster and its plugins to operate. This can be more convenient for managing permissions, as the vCluster Helm chart creates the Role, RoleBinding, and ServiceAccount while giving you complete control over the rules. This example disables cluster role rules and configures specific namespace permissions.

```yaml
rbac:
  role:
    enabled: true
    overwriteRules:
      - apiGroups: [""]
        resources: ["pods/status", "pods/ephemeralcontainers"]
        verbs: ["patch", "update"]
  clusterRole:
    enabled: false
```

## Config reference

<RBAC/>
