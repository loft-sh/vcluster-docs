---
title: RBAC
sidebar_label: rbac
sidebar_position: 7
description: Configuration for ...
---

import RBAC from '@site/docs/_partials/config/rbac.mdx'

Most rules required to operate your vCluster are automatically generated by [enabling resource syncing](/vcluster/vcluster-yaml/sync/).

:::note
When enabled, the following config fields may adjust default rules:

- [controlPlane.advanced.virtualScheduler](/vcluster/vcluster-yaml/control-plane/deployment/advanced/virtual-scheduler): adds required read permissions for the virtual scheduler
- [networking.replicateServices.fromHost](vcluster/vcluster-yaml/networking/replicate-services): adds required permissions to manage endpoints and services
- [observability.metrics.proxy.nodes](vcluster/vcluster-yaml/observability/metrics#observability-metrics-proxy-nodes): adds required read permissions for node resources
- [plugins](/vcluster/vcluster-yaml/plugins.mdx): adds `roles` and `clusterRoles` defined by each plugin
- [experimental.multiNamespaceMode](/vcluster/vcluster-yaml/experimental/multi-namespace-mode.mdx): adds required permissions for vCluster to manage namespaces and service accounts
- [experimental.genericSync](/vcluster/vcluster-yaml/experimental/generic-sync.mdx): adds `extraRules` defined by generic sync
:::

## Disable RBAC

In environments with strict controls where users cannot create service accounts, you may configure vCluster to use a managed service account. An administrator would be responsible for managing the `Role`, `RoleBinding`, `ClusterRole`, `ClusterRoleBinding`, and `ServiceAccount` resources. Once these are created, update the `vcluster.yaml` to disable RBAC, and configure the control plane to use the managed service account:
```yaml
controlPlane:
  advanced:
    serviceAccount:
      name: custom-vc-sa
rbac:
  role:
    enabled: false
  clusterRole:
    enabled: false
```

Alternatively, you may disable `ClusterRole` creation, as many users do not have the required permissions to create `ClusterRole` resources:
```yaml
rbac:
  clusterRole:
    enabled: false
```

## Extra Rules
Extra rules can be configured for when the automatically generated rules, [plugin](/vcluster/vcluster-yaml/plugins.mdx) rules, and [genericSync](/vcluster/vcluster-yaml/experimental/generic-sync.mdx) rules are insufficient. The usage of `extraRules` should be rare, but its usage is demonstrated below:
```yaml
rbac:
  role:
    enabled: true
    extraRules:
      - apiGroups: [""]
        resources: ["pods/status", "pods/ephemeralcontainers"]
        verbs: ["patch", "update"]
```

## Overwrite Rules

For better control use `overwriteRules` to ignore the automatically created rules. You will be responsible for enumerating rules required for the vCluster and its plugins to operate. This can be more convenient for managing permissions, as the vCluster chart will create the `Role`, `RoleBinding`, and `ServiceAccount` while giving you complete control over the rules. This example disables cluster role rules and configures specific namespace permissions:
```yaml
rbac:
  role:
    enabled: true
    overwriteRules:
      - apiGroups: [""]
        resources: ["pods/status", "pods/ephemeralcontainers"]
        verbs: ["patch", "update"]
  clusterRole:
    enabled: false
```

## Config reference

<RBAC/>
