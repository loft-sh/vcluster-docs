---
title: Experimental Generic Sync
sidebar_label: genericSync
sidebar_position: 3
description: Configuration for ...
---

import ExperimentalGenericSync from '@site/docs/_partials/config/experimental/genericSync.mdx'
import ProAdmonition from '@site/docs/_partials/admonitions/pro-admonition.mdx'

- Original documentation: https://www.vcluster.com/docs/syncer/other_resources/generic_sync
- Allows making host cluster CRDS / resource available to the vcluster for use by workloads
- The current documentation is hard to follow, since it's organized across multiple headings, which makes it seem like they are unrelated features, but really they are typically used together:
  - configuration syntax: https://www.vcluster.com/docs/syncer/other_resources/config_syntax
  - multi-namespace mode: https://www.vcluster.com/docs/syncer/other_resources/multi_namespace_mode
  - Hooks refer to [Sync Patches](https://www.vcluster.com/pro/docs/features/generic_resource_patches), which is a Pro feature
    - not sure how to represent this in the current docs structure, if genericSync is an OSS feature

## Suggested Outline

### Certificate Manager
- Use case: Allow users to create TLS certificates for websites and manage their own cert-manager `Issuer` from [here](https://github.com/loft-sh/vcluster/blob/main/generic-sync-examples/cert-manager))
- Configuring generic sync:
  - Mention that we need to enable multi-namespace mode to utilize cert-manager's `Issuer` resource
  - Also need multi-namespace mode to sync the namespace scoped `Secret` (created by cert-manager) back to the virtual cluster's namespace so that it can be used by the ingress
- Usage steps:
  - create an Issuer in the virtual cluster
  - create an Ingress in the virtual cluster that uses the Issuer through annotation: `cert-manager.io/issuer: ${ISSUER_NAME}`
  - Check that a `Certificate` resource gets created for the ingress
  - Check that a `Secret` with the name from `spec.tls[0].secretName` gets created and synced back to the vCluster with the generated certificate

### Istio Example
- Use case: Allow users to use `VirtualService` and `Gateway` resources to expose vCluster services
- Configuring generic sync:
  - use example [here](https://github.com/loft-sh/vcluster/tree/main/generic-sync-examples/istio)
  - This example is more advanced, since it shows using `patches` to rewrite parts of the `VirtualService` and `DestinationRule`
- Usage steps:
  - Deploy a sample application, perhaps the one from [istio getting started](https://istio.io/latest/docs/setup/getting-started/#bookinfo)
  - create the Gateway & VirtualService in the vCluster
  - see that browsing the website works using the host installed Istio

### Hooks Example (Node info remover)
- Use case: Hide node images from virtual cluster users
- Configuring Hooks:
  - use the [example](https://www.vcluster.com/pro/docs/features/generic_resource_patches#example---node-info-remover) from the existing docs
- Usage:
  - `kubectl get nodes` from the vCluster and see that the information is hidden

<ProAdmonition/>

### Patch Syntax Reference
- https://www.vcluster.com/docs/syncer/other_resources/config_syntax#patch-syntax

## Config reference

<ExperimentalGenericSync/>
