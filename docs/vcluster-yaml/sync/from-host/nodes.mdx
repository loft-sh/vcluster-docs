---
title: Nodes
sidebar_label:  nodes
sidebar_position: 1
description: Configuration for ...
---

import SyncNodes from '@site/docs/_partials/config/sync/fromHost/nodes.mdx'

Sync real nodes from the host cluster to the virtual cluster. If enabled, this implies that `fake-nodes` is disabled. See [Nodes](/architecture/nodes.mdx) for more information.

### Limiting pod scheduling to selected nodes

Vcluster allows you to limit on which nodes the pods synced by vCluster will run.
You can achieve this by combining `--node-selector` and `--enforce-node-selector` syncer flags.
The `--enforce-node-selector` flag is enabled by default.
When `--enforce-node-selector` flag is disabled, and a `--node-selector` is specified nodes will be synced based on the selector, as well as nodes running pod workloads.

When using vCluster helm chart or CLI, there are two options for setting the `--node-selector` flag.

This first option is recommended if you are not enabling node synchronization, and use [the fake nodes](./nodes.mdx), which are enabled by default. In such case, you would write a string representation of your node selector(e.g. "nodeLabel=labelValue") and set it as the value of `--node-selector` argument for syncer in your `vcluster.yaml`:
```
syncer:
  extraArgs:
  - --node-selector=nodeLabel=labelValue
```
then create or upgrade the vCluster with:

```
vcluster create my-vcluster --upgrade -f values.yaml
```

This second option is recommended if you are enabling synchronization of [the real nodes](./nodes.mdx) via helm values. This is how you would then set the selector in your `vcluster.yaml`:
```
sync:
  nodes:
    enabled: true
    nodeSelector: "nodeLabel=labelValue"
```
then create or upgrade the vCluster with:

```
vcluster create my-vcluster --upgrade -f values.yaml
```

:::info
When sync of the real nodes is enabled and nodeSelector is set, all nodes that match the selector will be synced into vCluster. Read more about Node sync modes on the [Nodes documentation page](./nodes.mdx).
:::


`nodes.enabled`:
- covered by the generic section here: https://www.vcluster.com/docs/syncer/config#enable-or-disable-synced-resources
- exists from the beginning. I believe one would need this to schedule any pods
- may be possible to disable this in the "control plane" vCluster when using [Isolated Control Plane](https://www.vcluster.com/pro/docs/features/isolated_control_planes), where all the workloads are scheduled to the workload cluster (where nodes syncing would be enabled)

`nodes.syncBackChanges`:
- replaces deprecated flag `--sync-node-changes`
- enables syncing labels and taints from virtual cluster nodes to the host nodes
- requires adding rbac permissions to modify the host node & status

`nodes.clearImageStatus`:
- sets `--node-clear-image-status`, added with this PR: https://github.com/loft-sh/vcluster/pull/826
- description says it's to prevent information about the node from leaking in a multi-tenant environment

`nodes.selector.all`:
- sets `--sync-all-nodes` syncer flag, see also [Example: Sync All Nodes](https://www.vcluster.com/docs/architecture/nodes#example-sync-all-nodes)

`nodes.selector.labels`:
- selects node labels that will be synced to the vCluster. This allows controlling which nodes can be used by the vCluster
- Some example use cases:
  - only allow nodes in a region
  - only allow nodes with a particular architecture
  - only use spot instances
  - prevent vClusters from sharing resources with critical infrastructure
- See also: https://www.vcluster.com/docs/security/other-topics#advanced-isolation

## Config reference

<SyncNodes/>
